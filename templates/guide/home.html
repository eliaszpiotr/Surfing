{% extends 'guide/base.html' %}

{% block content %}

    <div class="container">
        <div class="row">
            <div class="col-12 my-3">
                <h1>We found {{ spots_count }} spots around the world!</h1>
                <div id="map" class="map-container rounded my-4"
                     style="height: 500px; width: 1248px; margin: 0 auto; margin-top: 30px; overflow: hidden"></div>
            </div>
        </div>
    </div>

{% endblock %}

{% block extra_js %}
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        var mapElement = document.querySelector('#map');
        var map = L.map(mapElement).setView([0, 0], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        {% for spot in spots %}
            var marker{{ forloop.counter }} = L.marker([{{ spot.latitude }}, {{ spot.longitude }}]).addTo(map);
            marker{{ forloop.counter }}.bindPopup('<b>{{ spot.name }}</b>');
            marker{{ forloop.counter }}.on('click', (function (name) {
                return function () {
                    marker{{ forloop.counter }}.openPopup();
                };
            })("{{ spot.name }}"));
        {% endfor %}
    </script>

{% endblock %}

